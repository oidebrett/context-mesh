import { Button } from '@headlessui/react';
import Link from 'next/link';
import { usePathname } from 'next/navigation';

export const Menu: React.FC<{ onItemClick?: () => void }> = ({ onItemClick }) => {
    const pathname = usePathname();

    const getButtonClasses = (path: string) => {
        const isActive = pathname === path || (path === '/team-settings' && pathname === '/settings');
        return `py-1 px-2 w-full flex items-center gap-4 rounded-sm whitespace-nowrap ${isActive ? 'bg-[#eaeaea]' : 'hover:bg-[#eaeaea]'}`;
    };

    return (
        <div className="bg-neutral-50 h-full px-5 py-5 shadow-inner w-full">
            <div className="text-xl font-bold pt-0.5">Context Mesh</div>
            <ul className="mt-9 text-sm flex flex-col gap-2">
                <Link href="/" onClick={onItemClick}>
                    <Button className={getButtonClasses('/')}>
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="17" viewBox="0 0 16 17" fill="none">
                            <path
                                d="M9.5 15.299V11.894C9.49948 11.815 9.48334 11.7368 9.45252 11.664C9.42169 11.5912 9.37679 11.5252 9.32038 11.4698C9.26397 11.4144 9.19718 11.3708 9.12384 11.3413C9.05049 11.3118 8.97204 11.2971 8.893 11.298H7.107C6.94767 11.2972 6.79447 11.3594 6.68078 11.471C6.56709 11.5826 6.50211 11.7347 6.5 11.894V15.299H2.5C2.36877 15.2993 2.23878 15.2736 2.11747 15.2236C1.99615 15.1736 1.8859 15.1001 1.79301 15.0074C1.70013 14.9147 1.62644 14.8046 1.57616 14.6834C1.52588 14.5622 1.5 14.4322 1.5 14.301V7.296C1.5 6.915 1.718 6.567 2.06 6.4L8.02 1.5L13.916 6.389C14.0901 6.46823 14.2377 6.59587 14.3413 6.75669C14.4448 6.91751 14.4999 7.10473 14.5 7.296V14.301C14.5 14.4321 14.4742 14.562 14.4239 14.6831C14.3737 14.8043 14.3001 14.9144 14.2073 15.007C14.1146 15.0997 14.0044 15.1732 13.8832 15.2233C13.762 15.2734 13.6321 15.2991 13.501 15.299H9.5ZM8 9.099C8.17072 9.099 8.33976 9.06537 8.49749 9.00004C8.65521 8.93471 8.79852 8.83895 8.91924 8.71824C9.03996 8.59752 9.13571 8.45421 9.20104 8.29649C9.26637 8.13877 9.3 7.96972 9.3 7.799C9.3 7.62828 9.26637 7.45923 9.20104 7.30151C9.13571 7.14379 9.03996 7.00048 8.91924 6.87976C8.79852 6.75905 8.65521 6.66329 8.49749 6.59796C8.33976 6.53263 8.17072 6.499 8 6.499C7.65522 6.499 7.32456 6.63596 7.08076 6.87976C6.83696 7.12356 6.7 7.45422 6.7 7.799C6.7 8.14378 6.83696 8.47444 7.08076 8.71824C7.32456 8.96204 7.65522 9.099 8 9.099Z"
                                fill="#A3ACB9"
                            />
                            <path
                                d="M8.05248 1.50373C7.99822 1.4963 7.94301 1.5 7.89023 1.51461C7.83745 1.52923 7.7882 1.55445 7.74548 1.58873L0.602485 7.37273C0.560519 7.40579 0.525601 7.44692 0.499791 7.4937C0.473981 7.54047 0.457803 7.59194 0.45221 7.64507C0.446617 7.6982 0.451724 7.75191 0.467229 7.80304C0.482734 7.85416 0.508322 7.90166 0.542485 7.94273L1.29248 8.86773C1.43048 9.03773 1.68748 9.06773 1.86048 8.92773L8.05248 3.91273L14.2455 8.92773C14.4185 9.06773 14.6755 9.03773 14.8155 8.86773L15.5635 7.94173C15.5976 7.90066 15.6232 7.85316 15.6387 7.80204C15.6542 7.75091 15.6594 7.6972 15.6538 7.64407C15.6482 7.59094 15.632 7.53947 15.6062 7.4927C15.5804 7.44592 15.5455 7.40479 15.5035 7.37173L8.36049 1.58973C8.31765 1.55532 8.26823 1.53002 8.21527 1.5154C8.1623 1.50079 8.10691 1.49716 8.05248 1.50473V1.50373Z"
                                fill="#4F566B"
                            />
                        </svg>
                        Home
                    </Button>
                </Link>
                <Link href="/integrations" onClick={onItemClick}>
                    <Button className={getButtonClasses('/integrations')}>
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="17" viewBox="0 0 16 17" fill="none">
                            <path
                                d="M8 0.5C6.41775 0.5 4.87103 0.969192 3.55544 1.84824C2.23985 2.72729 1.21447 3.97672 0.608967 5.43853C0.00346629 6.90034 -0.15496 8.50887 0.153721 10.0607C0.462403 11.6126 1.22433 13.038 2.34315 14.1569C3.46197 15.2757 4.88743 16.0376 6.43928 16.3463C7.99113 16.655 9.59966 16.4965 11.0615 15.891C12.5233 15.2855 13.7727 14.2602 14.6518 12.9446C15.5308 11.629 16 10.0822 16 8.5C16 6.37827 15.1571 4.34344 13.6569 2.84315C12.1566 1.34285 10.1217 0.5 8 0.5ZM8 14.5C6.81331 14.5 5.65328 14.1481 4.66658 13.4888C3.67989 12.8295 2.91085 11.8925 2.45673 10.7961C2.0026 9.69975 1.88378 8.49334 2.11529 7.32946C2.3468 6.16557 2.91825 5.09647 3.75736 4.25736C4.59648 3.41824 5.66558 2.8468 6.82946 2.61529C7.99335 2.38378 9.19975 2.5026 10.2961 2.95672C11.3925 3.41085 12.3295 4.17988 12.9888 5.16658C13.6481 6.15327 14 7.31331 14 8.5C14 10.0913 13.3679 11.6174 12.2426 12.7426C11.1174 13.8679 9.5913 14.5 8 14.5Z"
                                fill="#4F566B"
                            />
                            <path
                                d="M11 7.5H9V5.5C9 5.23478 8.89464 4.98043 8.70711 4.79289C8.51957 4.60536 8.26522 4.5 8 4.5C7.73478 4.5 7.48043 4.60536 7.29289 4.79289C7.10536 4.98043 7 5.23478 7 5.5V7.5H5C4.73478 7.5 4.48043 7.60536 4.29289 7.79289C4.10536 7.98043 4 8.23478 4 8.5C4 8.76522 4.10536 9.01957 4.29289 9.20711C4.48043 9.39464 4.73478 9.5 5 9.5H7V11.5C7 11.7652 7.10536 12.0196 7.29289 12.2071C7.48043 12.3946 7.73478 12.5 8 12.5C8.26522 12.5 8.51957 12.3946 8.70711 12.2071C8.89464 12.0196 9 11.7652 9 11.5V9.5H11C11.2652 9.5 11.5196 9.39464 11.7071 9.20711C11.8946 9.01957 12 8.76522 12 8.5C12 8.23478 11.8946 7.98043 11.7071 7.79289C11.5196 7.60536 11.2652 7.5 11 7.5Z"
                                fill="#A3ACB9"
                            />
                        </svg>
                        Integrations
                    </Button>
                </Link>
                <Link href="/browser" onClick={onItemClick}>
                    <Button className={getButtonClasses('/browser')}>
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="17" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="text-[#4F566B]">
                            <circle cx="11" cy="11" r="8"></circle>
                            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                        </svg>
                        Data Browser
                    </Button>
                </Link>
                <Link href="/mappings" onClick={onItemClick}>
                    <Button className={getButtonClasses('/mappings')}>
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="17" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="text-[#4F566B]">
                            <path d="M12 20v-6M6 20V10M18 20V4" />
                        </svg>
                        Mappings
                    </Button>
                </Link>
                <Link href="/pdf-books" onClick={onItemClick}>
                    <Button className={getButtonClasses('/pdf-books')}>
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="17" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="text-[#4F566B]">
                            <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20" />
                            <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z" />
                        </svg>
                        PDF Books
                    </Button>
                </Link>
                <Link href="/team-settings" onClick={onItemClick}>
                    <Button className={getButtonClasses('/team-settings')}>
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="17" viewBox="0 0 16 17" fill="none">
                            <path
                                fillRule="evenodd"
                                clipRule="evenodd"
                                d="M14.197 7.517C13.967 7.517 12.59 7.517 12.017 6.822C12.017 6.707 11.902 6.707 11.902 6.591C11.787 5.781 12.82 4.74 12.934 4.624C13.164 4.393 13.164 4.045 13.049 3.93C12.934 3.814 12.475 3.351 12.361 3.12C12.246 2.888 11.901 3.004 11.672 3.236C11.442 3.466 10.525 4.393 9.722 4.276C9.607 4.276 9.607 4.161 9.492 4.161C8.803 3.698 8.803 2.31 8.803 2.079C8.803 1.731 8.689 1.5 8.459 1.5H7.311C7.082 1.5 6.967 1.731 6.967 2.079C6.967 2.309 6.967 3.699 6.279 4.277C6.164 4.277 6.164 4.393 6.049 4.393C5.246 4.393 4.328 3.467 4.099 3.236C3.869 3.004 3.525 3.004 3.409 3.12C3.295 3.351 2.836 3.814 2.607 3.93C2.492 4.045 2.492 4.393 2.721 4.624C2.951 4.855 3.869 5.781 3.754 6.591C3.754 6.707 3.639 6.707 3.639 6.822C3.18 7.517 1.803 7.517 1.574 7.517C1.23 7.517 1 7.632 1 7.864V8.905C1 9.136 1.23 9.368 1.574 9.368C1.804 9.368 3.18 9.368 3.754 10.062C3.754 10.178 3.869 10.178 3.869 10.293C3.984 11.103 2.951 12.145 2.836 12.26C2.606 12.492 2.606 12.839 2.721 12.955C2.836 13.07 3.295 13.533 3.41 13.765C3.525 13.88 3.869 13.88 4.098 13.649C4.328 13.417 5.246 12.492 6.049 12.607C6.164 12.607 6.164 12.723 6.279 12.723C6.967 13.302 6.967 14.574 6.967 14.921C6.967 15.153 7.197 15.5 7.427 15.5H8.459C8.689 15.5 8.918 15.269 8.918 14.921C8.918 14.691 8.918 13.301 9.607 12.723C9.721 12.723 9.721 12.607 9.837 12.607C10.639 12.492 11.672 13.533 11.787 13.649C12.017 13.88 12.361 13.88 12.475 13.764L13.279 12.954C13.393 12.839 13.393 12.492 13.164 12.26C12.934 12.029 12.016 11.103 12.131 10.293C12.131 10.178 12.246 10.178 12.246 10.062C12.82 9.368 14.082 9.368 14.426 9.368C14.656 9.368 15 9.136 15 8.905V7.864C14.77 7.632 14.541 7.517 14.197 7.517ZM7.885 10.987C6.508 10.987 5.361 9.831 5.361 8.442C5.361 7.054 6.508 5.897 7.885 5.897C9.262 5.897 10.41 7.054 10.41 8.442C10.41 9.831 9.262 10.988 7.885 10.988V10.987Z"
                                fill="#4F566B"
                            />
                        </svg>
                        Team Settings
                    </Button>
                </Link>
                <a href={`${process.env.NEXT_PUBLIC_BACKEND_URL || 'http://localhost:3010'}/auth/logout`} className="mt-auto">
                    <Button className="py-1 px-2 w-full flex items-center gap-4 rounded-sm whitespace-nowrap hover:bg-[#eaeaea] text-red-600">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="17" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                            <polyline points="16 17 21 12 16 7"></polyline>
                            <line x1="21" y1="12" x2="9" y2="12"></line>
                        </svg>
                        Logout
                    </Button>
                </a>
            </ul>
        </div>
    );
};
